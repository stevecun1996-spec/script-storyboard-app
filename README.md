# 剧本转分镜头系统（简化版）

一个轻量级的AI辅助工具，帮助你快速将剧本转换为标准化的分镜头脚本。

---

## ✨ 核心功能

1. **剧本输入** - 输入你的剧本文本
2. **AI自动分镜** - AI自动划分分镜头，包含场景、镜头、人物、对话等信息
3. **分镜编辑** - 可视化编辑每个分镜头
4. **Excel导出** - 一键导出完整的分镜头脚本到桌面

---

## 🚀 快速开始

### 安装依赖

```bash
pip install -r requirements.txt
```

### 启动应用

```bash
streamlit run app.py
```

或者直接双击 `run.bat` 文件

### 访问应用

打开浏览器访问：http://localhost:8501

---

## 📋 使用流程

### 步骤1：配置API

在侧边栏中：
1. 选择LLM品牌（支持10种主流LLM）
2. 选择模型（可使用自定义模型）
3. 输入API Key
4. （可选）刷新模型列表获取最新模型

### 步骤2：输入剧本

在主界面中粘贴或输入你的剧本内容，点击「开始分镜」

### 步骤3：编辑分镜

- 查看AI自动划分的分镜头
- 编辑描述、镜头角度、地点、时间等
- 编辑台词、旁白、音效
- 删除不需要的分镜
- 点击「导出Excel」保存结果

### 步骤4：导出结果

系统会自动将分镜头脚本导出为Excel文件，保存到桌面

---

## 💡 支持的LLM模型（10种品牌）

### OpenAI
- gpt-4o, gpt-4o-mini, gpt-4-turbo, gpt-3.5-turbo

### 通义千问
- qwen-plus, qwen-turbo, qwen-max

### 智谱GLM
- glm-4, glm-4v, glm-3-turbo

### Deepseek（推荐）
- deepseek-chat, deepseek-coder

### 月之暗面
- moonshot-v1-8k, moonshot-v1-32k, moonshot-v1-128k

### Claude
- claude-3-5-sonnet, claude-3-opus, claude-3-haiku

### 讯飞星火
- spark-v3.5, spark-v3.0, spark-v2.0

### 百川智能
- Baichuan2-Turbo, Baichuan2-53B

### MiniMax
- abab6-chat, abab5.5-chat

### LM Studio（本地）
- lmstudio-local（无需API Key）

**✨ 支持自定义模型输入！**

---

## 📁 项目结构

```
Script_to_Storyboard_Simple/
├── app.py                    # 主应用
├── config/                   # 配置模块
│   ├── llm_config.py        # LLM配置（10种品牌）
│   └── prompts.py           # 提示词模板
├── services/                 # 服务层
│   └── llm_service.py       # LLM服务（完善的API调用）
├── utils/                    # 工具模块
│   ├── scene_parser.py      # 分镜解析
│   └── export_utils.py      # 导出工具
├── requirements.txt          # 依赖包
├── run.bat                   # 启动脚本（Windows）
└── README.md                 # 说明文档
```

---

## 📊 导出格式

Excel文件包含两个工作表：

**分镜头表**：
- 序号
- 分镜描述
- 镜头角度
- 人物
- 地点
- 时间
- 情绪
- 台词
- 旁白
- 音效

**原始剧本表**：
- 完整的原始剧本文本

---

## ⚙️ 系统要求

- Python 3.8+
- 网络连接
- 任一支持的LLM API密钥

---

## 📝 使用提示

### 提升分镜质量
1. **剧本要详细**：包含场景、动作、对话
2. **格式要规范**：清晰的段落和场景标记
3. **模型要选好**：GPT-4o > Deepseek > GLM-4
4. **多次生成**：不满意可以重新生成

### 节省成本
1. **使用Deepseek**：性价比最高（推荐）
2. **先短后长**：先测试短剧本
3. **减少重试**：优化剧本再生成

### 提升效率
1. **自定义模型**：使用最新发布的模型
2. **刷新列表**：获取账户可用的所有模型
3. **快速编辑**：批量修改分镜信息
4. **标准化输出**：Excel格式便于后续使用

---

## 🔧 常见问题

### Q: 安装依赖时报错？
**A**: 确保Python版本 ≥ 3.8，尝试使用国内镜像源

### Q: API调用失败？
**A**: 检查API Key是否正确，账户余额是否充足

### Q: 分镜结果不理想？
**A**: 完善剧本细节，尝试更强的模型（如GPT-4o）

### Q: 找不到导出的Excel？
**A**: 文件自动保存在桌面，文件名：分镜头脚本_时间戳.xlsx

### Q: 如何使用自定义模型？
**A**: 在模型选择中选择"🔧 自定义模型"，然后输入模型名称

### Q: 刷新模型列表失败？
**A**: 某些品牌可能不支持此功能，直接使用自定义模型输入

---

## 🎯 适用场景

- 🎬 电影/电视剧分镜设计
- 🎨 动画分镜制作
- 🎮 游戏剧情可视化
- 📺 短视频脚本规划
- 📖 漫画分镜设计
- 🎓 影视教学演示

---

## 🆕 版本更新

### v2.0 (2024-10-30)

**主要改进**：
- ✅ 增加LLM品牌支持（4种 → 10种）
- ✅ 支持自定义模型输入
- ✅ 支持刷新模型列表
- ✅ 移除图像提示词生成（专注分镜脚本）
- ✅ 增加台词、旁白、音效字段
- ✅ 优化LLM服务调用
- ✅ 简化工作流程（3步 → 2步）
- ✅ 改进UI和用户体验

---

## 📄 许可证

本项目供学习和研究使用

---

**让剧本快速转化为专业分镜头脚本！** 🎬✨
